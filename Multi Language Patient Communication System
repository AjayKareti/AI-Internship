import random

# Sample patient database with language and preferred communication channel
patients = [
    {"id": 1, "name": "Ravi Kumar", "language": "Tamil", "channel": "SMS", "age": 60},
    {"id": 2, "name": "Ananya Rao", "language": "Telugu", "channel": "WhatsApp", "age": 30},
    {"id": 3, "name": "Joseph Mathew", "language": "Malayalam", "channel": "IVR", "age": 65},
    {"id": 4, "name": "Rahul Sharma", "language": "Hindi", "channel": "SMS", "age": 45},
    {"id": 5, "name": "David Thomas", "language": "English", "channel": "WhatsApp", "age": 25},
]

# Predefined multi-language messages
messages = {
    "Tamil": "à®‰à®™à¯à®•à®³à¯ à®¨à¯‡à®°à®®à¯ à®‰à®±à¯à®¤à®¿à®šà¯†à®¯à¯à®¯à®ªà¯à®ªà®Ÿà¯à®Ÿà®¤à¯. à®¤à®¯à®µà¯à®šà¯†à®¯à¯à®¤à¯ à®µà®°à¯à®•!",
    "Telugu": "à°®à±€ à°¨à°¿à°¯à°¾à°®à°•à°‚ à°¨à°¿à°°à±à°§à°¾à°°à°¿à°‚à°šà°¬à°¡à°¿à°‚à°¦à°¿. à°¦à°¯à°šà±‡à°¸à°¿ à°°à°‚à°¡à°¿!",
    "Malayalam": "à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´…à´ªàµ‹à´¯à´¿à´¨àµà´±àµà´®àµ†à´¨àµà´±àµ à´¸àµà´¥à´¿à´°àµ€à´•à´°à´¿à´šàµà´šà´¿à´°à´¿à´•àµà´•àµà´¨àµà´¨àµ. à´¦à´¯à´µà´¾à´¯à´¿ à´µà´°àµ‚!",
    "Hindi": "à¤†à¤ªà¤•à¤¾ à¤…à¤ªà¥‰à¤‡à¤‚à¤Ÿà¤®à¥‡à¤‚à¤Ÿ à¤•à¤¨à¥à¤«à¤°à¥à¤® à¤¹à¥‹ à¤—à¤¯à¤¾ à¤¹à¥ˆà¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤†à¤à¤‚!",
    "English": "Your appointment is confirmed. Please visit!",
}

def get_message(patient, messages, group="A"):
    """Fetch the message for the given patient based on their language and A/B testing group."""
    if group == "A":
        language = patient.get("language", "English")  # Native language for Group A
    else:
        language = "English"  # Default to English for Group B
    return messages.get(language, messages["English"])

def select_channel(patient):
    """Dynamic channel selection based on demographics."""
    if patient["age"] > 50:  # Elderly patients
        return "IVR"
    return patient.get("channel", "SMS")  # Default channel for others

def send_message(patient, messages, group="A"):
    """Simulate sending a message based on patient language, channel, and A/B testing group."""
    message = get_message(patient, messages, group)
    channel = select_channel(patient)
    print(f"ğŸ“© Sending via {channel} to {patient['name']} ({patient['language']}): {message}")

def simulate_sending(patients, messages):
    """Simulate sending messages to all patients with A/B testing."""
    print("ğŸ“¬ Sending messages to patients...\n")
    for patient in patients:
        # Randomly assign patients to Group A or Group B for A/B testing
        group = random.choice(["A", "B"])
        send_message(patient, messages, group)

def measure_effectiveness(patients):
    """Simulate confirmation tracking."""
    confirmed = sum(random.choices([0, 1], k=len(patients)))  # Random confirmations
    confirmation_rate = (confirmed / len(patients)) * 100
    print(f"\nâœ… Confirmation Rate: {confirmation_rate:.2f}%")

# Main simulation flow
simulate_sending(patients, messages)
measure_effectiveness(patients)
